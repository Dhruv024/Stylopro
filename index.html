<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stylo AI</title>
    
    <!-- Tailwind Configuration -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-out forwards',
                        'slide-up': 'slideUp 0.7s cubic-bezier(0.16, 1, 0.3, 1) forwards',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        },
                        slideUp: {
                            '0%': { opacity: '0', transform: 'translateY(20px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        }
                    }
                }
            }
        }
    </script>

    <script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', sans-serif; }
        /* Custom scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #52525b; border-radius: 3px; }
        
        select { -webkit-appearance: none; -moz-appearance: none; appearance: none; }
        
        .glass-panel {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(0, 0, 0, 0.05);
        }
        
        .dark .glass-panel {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .loader {
            border: 2px solid rgba(255,255,255,0.1);
            border-left-color: currentColor;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* Smooth transition for theme switching */
        body, .glass-panel, nav, footer {
            transition: background-color 0.3s ease, border-color 0.3s ease, color 0.3s ease;
        }
    </style>
</head>
<body class="bg-zinc-50 text-zinc-600 dark:bg-[#050505] dark:text-zinc-400 antialiased selection:bg-emerald-500/20 selection:text-emerald-500 flex flex-col min-h-screen">

    <!-- Navigation -->
    <nav class="fixed top-0 w-full z-50 border-b border-black/5 dark:border-white/5 bg-white/80 dark:bg-[#050505]/80 backdrop-blur-md">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <!-- Logo -->
                <div onclick="navigateTo('home')" class="flex items-center gap-2 cursor-pointer group">
                    <div class="w-8 h-8 bg-black dark:bg-white rounded-lg flex items-center justify-center transition-transform group-hover:scale-95">
                        <iconify-icon icon="lucide:sparkles" class="text-white dark:text-black text-lg" stroke-width="1.5"></iconify-icon>
                    </div>
                    <span class="text-black dark:text-white font-semibold tracking-tight text-lg">Stylo.ai</span>
                </div>

                <!-- Desktop Menu -->
                <div class="hidden md:flex items-center gap-8 text-sm font-medium">
                    <button onclick="navigateTo('home')" class="text-zinc-600 dark:text-zinc-400 hover:text-black dark:hover:text-white transition-colors">Home</button>
                    <button onclick="navigateTo('how-it-works')" class="text-zinc-600 dark:text-zinc-400 hover:text-black dark:hover:text-white transition-colors">How it works</button>
                    <button onclick="navigateTo('pricing')" class="text-zinc-600 dark:text-zinc-400 hover:text-black dark:hover:text-white transition-colors">Pricing</button>
                    <button onclick="navigateTo('contact')" class="text-zinc-600 dark:text-zinc-400 hover:text-black dark:hover:text-white transition-colors">Contact</button>
                </div>

                <!-- Right Side Actions -->
                <div class="flex items-center gap-3">
                    
                    <!-- Theme Toggle -->
                    <div class="relative">
                        <button onclick="toggleThemeMenu()" class="flex items-center justify-center w-8 h-8 rounded-full hover:bg-black/5 dark:hover:bg-white/10 text-zinc-600 dark:text-zinc-400 transition-colors">
                            <iconify-icon id="theme-icon" icon="lucide:moon" stroke-width="1.5"></iconify-icon>
                        </button>
                        <!-- Theme Dropdown -->
                        <div id="theme-menu" class="hidden absolute right-0 mt-2 w-32 bg-white dark:bg-zinc-900 rounded-lg shadow-xl border border-black/5 dark:border-white/10 overflow-hidden z-50">
                            <button onclick="setTheme('light')" class="w-full text-left px-4 py-2 text-xs font-medium hover:bg-zinc-100 dark:hover:bg-zinc-800 flex items-center gap-2">
                                <iconify-icon icon="lucide:sun" stroke-width="1.5"></iconify-icon> Light
                            </button>
                            <button onclick="setTheme('dark')" class="w-full text-left px-4 py-2 text-xs font-medium hover:bg-zinc-100 dark:hover:bg-zinc-800 flex items-center gap-2">
                                <iconify-icon icon="lucide:moon" stroke-width="1.5"></iconify-icon> Dark
                            </button>
                            <button onclick="setTheme('system')" class="w-full text-left px-4 py-2 text-xs font-medium hover:bg-zinc-100 dark:hover:bg-zinc-800 flex items-center gap-2">
                                <iconify-icon icon="lucide:monitor" stroke-width="1.5"></iconify-icon> System
                            </button>
                        </div>
                    </div>

                    <div class="h-4 w-[1px] bg-zinc-300 dark:bg-zinc-800 mx-1"></div>

                    <!-- Auth State (Logged Out) -->
                    <div id="auth-logged-out" class="hidden md:flex items-center gap-3">
                        <button onclick="openAuthModal('login')" class="text-sm font-medium text-zinc-600 dark:text-zinc-300 hover:text-black dark:hover:text-white transition-colors">Log in</button>
                        <button onclick="openAuthModal('signup')" class="bg-black dark:bg-white text-white dark:text-black text-sm font-medium px-4 py-2 rounded-full hover:opacity-90 transition-all">Sign up</button>
                    </div>

                    <!-- Auth State (Logged In) -->
                    <div id="auth-logged-in" class="hidden items-center gap-3">
                        <div class="flex flex-col items-end mr-1">
                            <span id="user-display-email" class="text-xs font-medium text-black dark:text-white">user@example.com</span>
                            <span class="text-[10px] text-zinc-500 uppercase tracking-wider">Free Plan</span>
                        </div>
                        <button onclick="logout()" class="w-8 h-8 rounded-full bg-emerald-500 text-white flex items-center justify-center font-bold text-xs" title="Logout">
                            <iconify-icon icon="lucide:log-out" stroke-width="1.5"></iconify-icon>
                        </button>
                    </div>

                    <!-- Mobile Menu Button -->
                    <div class="md:hidden flex items-center ml-2">
                        <button class="text-black dark:text-white">
                            <iconify-icon icon="lucide:menu" class="text-2xl" stroke-width="1.5"></iconify-icon>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Page Content Router -->
    <main id="app-content" class="pt-24 pb-12 px-4 sm:px-6 lg:px-8 max-w-7xl mx-auto flex-grow w-full">
        
        <!-- === HOME PAGE === -->
        <div id="page-home" class="page-section animate-fade-in">
            <!-- Hero Section -->
            <div class="text-center max-w-3xl mx-auto mb-16 pt-8">
                <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full border border-black/5 dark:border-white/10 bg-zinc-100 dark:bg-white/5 text-xs font-medium text-zinc-900 dark:text-white mb-6 animate-slide-up" style="animation-delay: 0ms;">
                    <span class="relative flex h-2 w-2">
                    <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"></span>
                    <span class="relative inline-flex rounded-full h-2 w-2 bg-emerald-500"></span>
                    </span>
                    AI V2.0 Now Live
                </div>
                <h1 class="text-4xl sm:text-5xl md:text-6xl font-semibold text-black dark:text-white tracking-tight mb-6 animate-slide-up" style="animation-delay: 100ms;">
                    Redefine your style with <br/> intelligent fashion.
                </h1>
                <p class="text-lg text-zinc-600 dark:text-zinc-500 max-w-xl mx-auto leading-relaxed animate-slide-up" style="animation-delay: 200ms;">
                    Upload a photo, choose the occasion, and let our AI stylist generate the perfect outfit tailored to you in seconds.
                </p>
            </div>

            <!-- The Tool Interface -->
            <div class="grid grid-cols-1 lg:grid-cols-12 gap-6 animate-slide-up mb-32" style="animation-delay: 300ms;">
                
                <!-- Sidebar / Controls (Left) -->
                <div class="lg:col-span-4 space-y-4">
                    <div class="glass-panel rounded-2xl p-6 h-full flex flex-col justify-between shadow-sm">
                        <div class="space-y-6">
                            <!-- Step 1: Gender -->
                            <div>
                                <label class="block text-xs font-semibold text-zinc-500 dark:text-zinc-400 mb-2 uppercase tracking-wide">1. Select Gender</label>
                                <div class="grid grid-cols-2 gap-2 p-1 bg-zinc-100 dark:bg-zinc-900/50 rounded-lg border border-black/5 dark:border-white/5">
                                    <button onclick="selectGender('male')" id="btn-male" class="flex items-center justify-center gap-2 py-2.5 rounded-md text-sm font-medium transition-all bg-black dark:bg-zinc-800 text-white shadow-sm ring-1 ring-black/5 dark:ring-white/10">
                                        <iconify-icon icon="lucide:user" stroke-width="1.5"></iconify-icon> Male
                                    </button>
                                    <button onclick="selectGender('female')" id="btn-female" class="flex items-center justify-center gap-2 py-2.5 rounded-md text-sm font-medium transition-all text-zinc-500 hover:text-zinc-800 dark:hover:text-zinc-300">
                                        <iconify-icon icon="lucide:user-circle" stroke-width="1.5"></iconify-icon> Female
                                    </button>
                                </div>
                            </div>

                            <!-- Step 2: Occasion -->
                            <div>
                                <label class="block text-xs font-semibold text-zinc-500 dark:text-zinc-400 mb-2 uppercase tracking-wide">2. Occasion</label>
                                <div class="relative">
                                    <select id="occasion-select" class="w-full bg-zinc-50 dark:bg-zinc-900/50 border border-zinc-200 dark:border-white/10 text-black dark:text-white text-sm rounded-lg focus:ring-1 focus:ring-black/20 dark:focus:ring-white/30 focus:border-black/20 dark:focus:border-white/30 block w-full p-3 transition-colors outline-none cursor-pointer">
                                        <option value="casual">Casual Day Out</option>
                                        <option value="business">Business Professional</option>
                                        <option value="party">Evening Party / Club</option>
                                        <option value="gym">Gym / Athleisure</option>
                                        <option value="winter">Winter / Cold Weather</option>
                                        <option value="wedding">Wedding Guest</option>
                                        <option value="date">Date Night</option>
                                        <option value="summer">Summer Beach</option>
                                        <option value="festival">Music Festival</option>
                                        <option value="airport">Airport Comfort</option>
                                    </select>
                                    <div class="absolute inset-y-0 right-0 flex items-center px-3 pointer-events-none text-zinc-500">
                                        <iconify-icon icon="lucide:chevron-down" stroke-width="1.5"></iconify-icon>
                                    </div>
                                </div>
                            </div>

                            <!-- Step 3: Upload -->
                            <div>
                                <label class="block text-xs font-semibold text-zinc-500 dark:text-zinc-400 mb-2 uppercase tracking-wide">3. Your Photo</label>
                                <div id="dropzone" class="relative group cursor-pointer">
                                    <input type="file" id="file-upload" class="absolute inset-0 w-full h-full opacity-0 z-10 cursor-pointer" accept="image/*">
                                    <div class="border border-dashed border-zinc-300 dark:border-white/15 rounded-xl p-8 bg-zinc-50/50 dark:bg-zinc-900/20 group-hover:bg-zinc-100 dark:group-hover:bg-zinc-900/40 group-hover:border-zinc-400 dark:group-hover:border-white/30 transition-all text-center">
                                        <div id="upload-placeholder">
                                            <div class="w-10 h-10 bg-zinc-200 dark:bg-zinc-800 rounded-full flex items-center justify-center mx-auto mb-3 group-hover:scale-110 transition-transform">
                                                <iconify-icon icon="lucide:upload-cloud" class="text-zinc-500 dark:text-zinc-400 text-lg" stroke-width="1.5"></iconify-icon>
                                            </div>
                                            <p class="text-sm text-zinc-700 dark:text-zinc-300 font-medium">Click to upload</p>
                                            <p class="text-xs text-zinc-500 mt-1">JPG, PNG up to 5MB</p>
                                        </div>
                                        <div id="upload-success" class="hidden flex items-center justify-center gap-2">
                                            <iconify-icon icon="lucide:check-circle" class="text-emerald-500" stroke-width="1.5"></iconify-icon>
                                            <span class="text-sm text-black dark:text-white" id="filename">photo.jpg</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Generate Button -->
                        <div class="mt-8">
                            <button onclick="generateOutfit()" id="generate-btn" class="w-full group relative overflow-hidden rounded-lg bg-black dark:bg-white p-3 text-sm font-medium text-white dark:text-black transition-all hover:opacity-90 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed">
                                <span class="relative z-10 flex items-center justify-center gap-2">
                                    <iconify-icon icon="lucide:wand-2" class="group-hover:rotate-12 transition-transform" stroke-width="1.5"></iconify-icon>
                                    Generate Outfit
                                </span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Preview / Result Area (Right) -->
                <!-- Increased height from h-auto/550px to min-h-[700px] -->
                <div class="lg:col-span-8 min-h-[700px] lg:h-auto">
                    <div class="glass-panel rounded-2xl h-full relative overflow-hidden flex items-center justify-center group shadow-sm">
                        
                        <!-- Background Grid Pattern -->
                        <div class="absolute inset-0 z-0 opacity-[0.03] dark:opacity-20 pointer-events-none" style="background-image: radial-gradient(currentColor 1px, transparent 1px); background-size: 24px 24px;"></div>

                        <!-- Default Empty State -->
                        <div id="empty-state" class="text-center z-10">
                            <div class="w-16 h-16 bg-zinc-100 dark:bg-white/5 rounded-2xl border border-black/5 dark:border-white/10 flex items-center justify-center mx-auto mb-4 backdrop-blur-sm shadow-xl">
                                <iconify-icon icon="lucide:image" class="text-zinc-400 dark:text-zinc-500 text-3xl" stroke-width="1.5"></iconify-icon>
                            </div>
                            <p class="text-zinc-500 dark:text-zinc-400 font-medium">No image generated yet</p>
                            <p class="text-zinc-400 dark:text-zinc-600 text-sm mt-1">Upload a photo to get started</p>
                        </div>

                        <!-- User Image Preview (Hidden initially) -->
                        <img id="user-preview" src="" alt="User Upload" class="hidden absolute inset-0 w-full h-full object-cover z-10 opacity-30 blur-sm scale-105 transition-all duration-700">

                        <!-- Result Image (Hidden initially) -->
                        <div id="result-container" class="hidden absolute inset-0 z-20 w-full h-full bg-zinc-900">
                             <!-- Image -->
                            <img id="result-image" src="" class="w-full h-full object-cover opacity-0 transition-opacity duration-1000">
                            
                            <!-- Actions Overlay -->
                            <div class="absolute bottom-6 right-6 flex gap-2">
                                <button class="bg-black/50 hover:bg-black/70 backdrop-blur-md text-white border border-white/10 p-2.5 rounded-lg transition-colors">
                                    <iconify-icon icon="lucide:download" stroke-width="1.5"></iconify-icon>
                                </button>
                                <button class="bg-black/50 hover:bg-black/70 backdrop-blur-md text-white border border-white/10 p-2.5 rounded-lg transition-colors">
                                    <iconify-icon icon="lucide:share-2" stroke-width="1.5"></iconify-icon>
                                </button>
                                <button class="bg-white text-black p-2.5 px-4 rounded-lg font-medium text-sm hover:bg-zinc-200 transition-colors">
                                    Shop Look
                                </button>
                            </div>
                            
                            <!-- AI Badge -->
                            <div class="absolute top-6 left-6 flex items-center gap-2 bg-black/40 backdrop-blur-md border border-white/10 px-3 py-1.5 rounded-full">
                                <iconify-icon icon="lucide:sparkles" class="text-emerald-400 text-xs"></iconify-icon>
                                <span class="text-xs text-white font-medium">AI Generated Style</span>
                            </div>
                        </div>

                        <!-- Loading Overlay -->
                        <div id="loader-overlay" class="hidden absolute inset-0 z-30 bg-white/80 dark:bg-black/60 backdrop-blur-md flex flex-col items-center justify-center">
                            <div class="loader mb-4 text-black dark:text-white"></div>
                            <p class="text-zinc-600 dark:text-zinc-300 text-sm font-medium animate-pulse">Analyzing style...</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Trusted By Section -->
            <div class="py-12 border-t border-black/5 dark:border-white/5 border-b border-black/5 dark:border-white/5 bg-white/50 dark:bg-white/5 rounded-3xl mb-24">
                <p class="text-center text-[10px] uppercase font-semibold tracking-widest text-zinc-500 mb-8">Trusted by Fashion Tech Leaders</p>
                <div class="flex flex-wrap justify-center items-center gap-8 md:gap-16 opacity-70 grayscale transition-all duration-500 hover:grayscale-0 hover:opacity-100">
                    <div class="flex items-center gap-2">
                        <iconify-icon icon="simple-icons:vercel" class="text-xl dark:text-white"></iconify-icon>
                        <span class="font-semibold text-lg text-black dark:text-white tracking-tight">VERCEL</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <iconify-icon icon="simple-icons:linear" class="text-xl dark:text-white"></iconify-icon>
                        <span class="font-semibold text-lg text-black dark:text-white tracking-tight">LINEAR</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <iconify-icon icon="simple-icons:stripe" class="text-xl dark:text-white"></iconify-icon>
                        <span class="font-semibold text-lg text-black dark:text-white tracking-tight">STRIPE</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <iconify-icon icon="simple-icons:tailwindcss" class="text-xl dark:text-white"></iconify-icon>
                        <span class="font-semibold text-lg text-black dark:text-white tracking-tight">TAILWIND</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <iconify-icon icon="simple-icons:framer" class="text-xl dark:text-white"></iconify-icon>
                        <span class="font-semibold text-lg text-black dark:text-white tracking-tight">FRAMER</span>
                    </div>
                </div>
            </div>

            <!-- How Stylo Works (New Section) -->
            <div class="max-w-6xl mx-auto mb-32">
                <div class="text-center mb-16">
                    <h2 class="text-3xl font-semibold text-black dark:text-white mb-4">How Stylo Works</h2>
                    <p class="text-zinc-500 dark:text-zinc-400 max-w-2xl mx-auto">From upload to runway-ready in three simple steps. Our proprietary GAN technology handles the physics of fabric drape.</p>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <!-- Step 1 -->
                    <div class="bg-white dark:bg-white/5 border border-zinc-200 dark:border-white/10 rounded-2xl p-8 hover:shadow-lg transition-shadow duration-300">
                        <div class="w-12 h-12 bg-emerald-50 dark:bg-emerald-500/10 rounded-lg flex items-center justify-center mb-6">
                            <iconify-icon icon="lucide:scan-face" class="text-emerald-500 text-2xl" stroke-width="1.5"></iconify-icon>
                        </div>
                        <h3 class="text-lg font-semibold text-black dark:text-white mb-3">1. Analysis</h3>
                        <p class="text-sm text-zinc-500 dark:text-zinc-400 leading-relaxed">Computer vision algorithms identify body type, skin undertones, and pose to create a 3D wireframe mesh.</p>
                    </div>

                    <!-- Step 2 -->
                    <div class="bg-white dark:bg-white/5 border border-zinc-200 dark:border-white/10 rounded-2xl p-8 hover:shadow-lg transition-shadow duration-300">
                        <div class="w-12 h-12 bg-purple-50 dark:bg-purple-500/10 rounded-lg flex items-center justify-center mb-6">
                            <iconify-icon icon="lucide:wand-2" class="text-purple-500 text-2xl" stroke-width="1.5"></iconify-icon>
                        </div>
                        <h3 class="text-lg font-semibold text-black dark:text-white mb-3">2. Generation</h3>
                        <p class="text-sm text-zinc-500 dark:text-zinc-400 leading-relaxed">The AI selects items matching your occasion and renders them onto your mesh with realistic lighting and shadows.</p>
                    </div>

                    <!-- Step 3 -->
                    <div class="bg-white dark:bg-white/5 border border-zinc-200 dark:border-white/10 rounded-2xl p-8 hover:shadow-lg transition-shadow duration-300">
                        <div class="w-12 h-12 bg-blue-50 dark:bg-blue-500/10 rounded-lg flex items-center justify-center mb-6">
                            <iconify-icon icon="lucide:shopping-bag" class="text-blue-500 text-2xl" stroke-width="1.5"></iconify-icon>
                        </div>
                        <h3 class="text-lg font-semibold text-black dark:text-white mb-3">3. Commerce</h3>
                        <p class="text-sm text-zinc-500 dark:text-zinc-400 leading-relaxed">Visual search matches the generated items with real inventory from 500+ partner stores for instant purchase.</p>
                    </div>
                </div>
            </div>

            <!-- Home Pricing Section (Moved from separate page) -->
            <div class="max-w-6xl mx-auto pb-12">
                <div class="text-center mb-12">
                    <h2 class="text-3xl font-semibold text-black dark:text-white tracking-tight mb-4">Simple, transparent pricing</h2>
                    <p class="text-zinc-500">Choose the plan that fits your wardrobe needs.</p>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <!-- Free Plan -->
                    <div class="glass-panel p-8 rounded-2xl flex flex-col">
                        <div class="mb-4">
                            <span class="text-zinc-500 font-medium">Starter</span>
                            <div class="flex items-baseline gap-1 mt-2">
                                <span class="text-4xl font-semibold text-black dark:text-white">$0</span>
                                <span class="text-zinc-500">/mo</span>
                            </div>
                        </div>
                        <ul class="space-y-3 mb-8 flex-1">
                            <li class="flex items-center gap-2 text-sm text-zinc-600 dark:text-zinc-300">
                                <iconify-icon icon="lucide:check" class="text-emerald-500" stroke-width="1.5"></iconify-icon> 5 Generations per day
                            </li>
                            <li class="flex items-center gap-2 text-sm text-zinc-600 dark:text-zinc-300">
                                <iconify-icon icon="lucide:check" class="text-emerald-500" stroke-width="1.5"></iconify-icon> Standard SD Quality
                            </li>
                            <li class="flex items-center gap-2 text-sm text-zinc-600 dark:text-zinc-300">
                                <iconify-icon icon="lucide:check" class="text-emerald-500" stroke-width="1.5"></iconify-icon> Ad-supported
                            </li>
                        </ul>
                        <button class="w-full py-2 rounded-lg border border-black/10 dark:border-white/10 text-black dark:text-white text-sm font-medium hover:bg-black/5 dark:hover:bg-white/5 transition-colors">Get Started</button>
                    </div>

                    <!-- Enthusiast Plan ($2.99) -->
                    <div class="glass-panel p-8 rounded-2xl flex flex-col relative border-emerald-500/30">
                        <div class="absolute top-0 inset-x-0 h-1 bg-gradient-to-r from-emerald-400 to-teal-500"></div>
                        <div class="mb-4">
                            <span class="text-emerald-600 dark:text-emerald-400 font-medium">Enthusiast</span>
                            <div class="flex items-baseline gap-1 mt-2">
                                <span class="text-4xl font-semibold text-black dark:text-white">$2.99</span>
                                <span class="text-zinc-500">/mo</span>
                            </div>
                        </div>
                        <ul class="space-y-3 mb-8 flex-1">
                            <li class="flex items-center gap-2 text-sm text-zinc-600 dark:text-zinc-300">
                                <iconify-icon icon="lucide:check" class="text-emerald-500" stroke-width="1.5"></iconify-icon> 15 Generations per day
                            </li>
                            <li class="flex items-center gap-2 text-sm text-zinc-600 dark:text-zinc-300">
                                <iconify-icon icon="lucide:check" class="text-emerald-500" stroke-width="1.5"></iconify-icon> 1080p HD Quality
                            </li>
                            <li class="flex items-center gap-2 text-sm text-zinc-600 dark:text-zinc-300">
                                <iconify-icon icon="lucide:check" class="text-emerald-500" stroke-width="1.5"></iconify-icon> No Watermarks
                            </li>
                             <li class="flex items-center gap-2 text-sm text-zinc-600 dark:text-zinc-300">
                                <iconify-icon icon="lucide:check" class="text-emerald-500" stroke-width="1.5"></iconify-icon> Priority Processing
                            </li>
                        </ul>
                        <button class="w-full py-2 rounded-lg bg-emerald-600 text-white text-sm font-medium hover:bg-emerald-700 transition-colors">Upgrade</button>
                    </div>

                    <!-- Pro Plan ($9.99) -->
                    <div class="glass-panel p-8 rounded-2xl flex flex-col relative overflow-hidden">
                        <div class="absolute top-0 right-0 bg-black dark:bg-white text-white dark:text-black text-[10px] font-bold px-3 py-1 rounded-bl-lg uppercase tracking-wider">Best Value</div>
                        <div class="mb-4">
                            <span class="text-zinc-500 font-medium">Pro Stylist</span>
                            <div class="flex items-baseline gap-1 mt-2">
                                <span class="text-4xl font-semibold text-black dark:text-white">$9.99</span>
                                <span class="text-zinc-500">/mo</span>
                            </div>
                        </div>
                        <ul class="space-y-3 mb-8 flex-1">
                            <li class="flex items-center gap-2 text-sm text-zinc-600 dark:text-zinc-300">
                                <iconify-icon icon="lucide:check" class="text-emerald-500" stroke-width="1.5"></iconify-icon> Unlimited Generations
                            </li>
                            <li class="flex items-center gap-2 text-sm text-zinc-600 dark:text-zinc-300">
                                <iconify-icon icon="lucide:check" class="text-emerald-500" stroke-width="1.5"></iconify-icon> 4K Ultra HD Rendering
                            </li>
                            <li class="flex items-center gap-2 text-sm text-zinc-600 dark:text-zinc-300">
                                <iconify-icon icon="lucide:check" class="text-emerald-500" stroke-width="1.5"></iconify-icon> Virtual Closet Access
                            </li>
                            <li class="flex items-center gap-2 text-sm text-zinc-600 dark:text-zinc-300">
                                <iconify-icon icon="lucide:check" class="text-emerald-500" stroke-width="1.5"></iconify-icon> API Access
                            </li>
                        </ul>
                        <button class="w-full py-2 rounded-lg bg-black dark:bg-white text-white dark:text-black text-sm font-medium hover:opacity-90 transition-colors">Go Pro</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- === HOW IT WORKS PAGE (Details) === -->
        <div id="page-how-it-works" class="page-section hidden animate-fade-in max-w-4xl mx-auto pt-8">
            <div class="text-center mb-16">
                <h2 class="text-3xl font-semibold text-black dark:text-white mb-4">Deep Dive: How Stylo Works</h2>
                <p class="text-zinc-500">Technical breakdown of our pipeline.</p>
            </div>
            
            <div class="space-y-12">
                <div class="flex flex-col md:flex-row gap-8 items-center">
                    <div class="w-full md:w-1/2 glass-panel p-2 rounded-2xl h-64 flex items-center justify-center overflow-hidden">
                        <img src="https://images.unsplash.com/photo-1555421689-d68471e189f2?q=80&w=2070&auto=format&fit=crop" class="w-full h-full object-cover rounded-xl opacity-90 hover:scale-105 transition-transform duration-500" alt="Scanning face">
                    </div>
                    <div class="w-full md:w-1/2">
                        <span class="text-emerald-500 font-bold text-sm tracking-wide uppercase">Step 01</span>
                        <h3 class="text-2xl font-medium text-black dark:text-white mt-2 mb-3">Analysis & Extraction</h3>
                        <p class="text-zinc-600 dark:text-zinc-400 leading-relaxed">Our computer vision algorithms scan your uploaded photo to identify body type, skin undertones, and existing hair/eye color profiles to build a unique style DNA.</p>
                    </div>
                </div>

                <div class="flex flex-col md:flex-row-reverse gap-8 items-center">
                    <div class="w-full md:w-1/2 glass-panel p-2 rounded-2xl h-64 flex items-center justify-center overflow-hidden">
                        <img src="https://images.unsplash.com/photo-1558769132-cb1aea458c5e?q=80&w=1974&auto=format&fit=crop" class="w-full h-full object-cover rounded-xl opacity-90 hover:scale-105 transition-transform duration-500" alt="Digital fashion">
                    </div>
                    <div class="w-full md:w-1/2">
                        <span class="text-emerald-500 font-bold text-sm tracking-wide uppercase">Step 02</span>
                        <h3 class="text-2xl font-medium text-black dark:text-white mt-2 mb-3">Generative Styling</h3>
                        <p class="text-zinc-600 dark:text-zinc-400 leading-relaxed">Using the selected occasion, we generate photorealistic clothing items mapped perfectly to your pose. We reference millions of trend data points to ensure relevance.</p>
                    </div>
                </div>

                <div class="flex flex-col md:flex-row gap-8 items-center">
                    <div class="w-full md:w-1/2 glass-panel p-2 rounded-2xl h-64 flex items-center justify-center overflow-hidden">
                        <img src="https://images.unsplash.com/photo-1483985988355-763728e1935b?q=80&w=2070&auto=format&fit=crop" class="w-full h-full object-cover rounded-xl opacity-90 hover:scale-105 transition-transform duration-500" alt="Shopping bag">
                    </div>
                    <div class="w-full md:w-1/2">
                        <span class="text-emerald-500 font-bold text-sm tracking-wide uppercase">Step 03</span>
                        <h3 class="text-2xl font-medium text-black dark:text-white mt-2 mb-3">Shop the Look</h3>
                        <p class="text-zinc-600 dark:text-zinc-400 leading-relaxed">Don't just visualize it. We use visual search to find the exact (or closest matching) items from partner stores so you can purchase the entire outfit instantly.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- === PRICING PAGE (Separate tab) === -->
        <div id="page-pricing" class="page-section hidden animate-fade-in pt-8">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-semibold text-black dark:text-white tracking-tight mb-4">Pricing Plans</h2>
                <p class="text-zinc-500">Flexible options for everyone.</p>
            </div>
             <!-- Duplicate grid for the dedicated page -->
             <div class="grid grid-cols-1 md:grid-cols-3 gap-6 max-w-6xl mx-auto">
                 <!-- Repeated content from Home for consistency -->
                  <!-- Free -->
                  <div class="glass-panel p-8 rounded-2xl flex flex-col">
                    <div class="mb-4">
                        <span class="text-zinc-500 font-medium">Starter</span>
                        <div class="flex items-baseline gap-1 mt-2">
                            <span class="text-4xl font-semibold text-black dark:text-white">$0</span>
                            <span class="text-zinc-500">/mo</span>
                        </div>
                    </div>
                    <ul class="space-y-3 mb-8 flex-1">
                        <li class="flex items-center gap-2 text-sm text-zinc-600 dark:text-zinc-300">
                            <iconify-icon icon="lucide:check" class="text-emerald-500" stroke-width="1.5"></iconify-icon> 5 Generations per day
                        </li>
                        <li class="flex items-center gap-2 text-sm text-zinc-600 dark:text-zinc-300">
                            <iconify-icon icon="lucide:check" class="text-emerald-500" stroke-width="1.5"></iconify-icon> Standard SD Quality
                        </li>
                    </ul>
                    <button class="w-full py-2 rounded-lg border border-black/10 dark:border-white/10 text-black dark:text-white text-sm font-medium hover:bg-black/5 dark:hover:bg-white/5 transition-colors">Get Started</button>
                </div>
                <!-- Enthusiast -->
                <div class="glass-panel p-8 rounded-2xl flex flex-col relative border-emerald-500/30">
                    <div class="absolute top-0 inset-x-0 h-1 bg-gradient-to-r from-emerald-400 to-teal-500"></div>
                    <div class="mb-4">
                        <span class="text-emerald-600 dark:text-emerald-400 font-medium">Enthusiast</span>
                        <div class="flex items-baseline gap-1 mt-2">
                            <span class="text-4xl font-semibold text-black dark:text-white">$2.99</span>
                            <span class="text-zinc-500">/mo</span>
                        </div>
                    </div>
                    <ul class="space-y-3 mb-8 flex-1">
                        <li class="flex items-center gap-2 text-sm text-zinc-600 dark:text-zinc-300">
                            <iconify-icon icon="lucide:check" class="text-emerald-500" stroke-width="1.5"></iconify-icon> 15 Generations per day
                        </li>
                        <li class="flex items-center gap-2 text-sm text-zinc-600 dark:text-zinc-300">
                            <iconify-icon icon="lucide:check" class="text-emerald-500" stroke-width="1.5"></iconify-icon> 1080p HD Quality
                        </li>
                    </ul>
                    <button class="w-full py-2 rounded-lg bg-emerald-600 text-white text-sm font-medium hover:bg-emerald-700 transition-colors">Upgrade</button>
                </div>
                <!-- Pro -->
                <div class="glass-panel p-8 rounded-2xl flex flex-col relative overflow-hidden">
                    <div class="absolute top-0 right-0 bg-black dark:bg-white text-white dark:text-black text-[10px] font-bold px-3 py-1 rounded-bl-lg uppercase tracking-wider">Best Value</div>
                    <div class="mb-4">
                        <span class="text-zinc-500 font-medium">Pro Stylist</span>
                        <div class="flex items-baseline gap-1 mt-2">
                            <span class="text-4xl font-semibold text-black dark:text-white">$9.99</span>
                            <span class="text-zinc-500">/mo</span>
                        </div>
                    </div>
                    <ul class="space-y-3 mb-8 flex-1">
                        <li class="flex items-center gap-2 text-sm text-zinc-600 dark:text-zinc-300">
                            <iconify-icon icon="lucide:check" class="text-emerald-500" stroke-width="1.5"></iconify-icon> Unlimited Generations
                        </li>
                        <li class="flex items-center gap-2 text-sm text-zinc-600 dark:text-zinc-300">
                            <iconify-icon icon="lucide:check" class="text-emerald-500" stroke-width="1.5"></iconify-icon> 4K Ultra HD Rendering
                        </li>
                    </ul>
                    <button class="w-full py-2 rounded-lg bg-black dark:bg-white text-white dark:text-black text-sm font-medium hover:opacity-90 transition-colors">Go Pro</button>
                </div>
             </div>
        </div>

        <!-- === CONTACT PAGE === -->
        <div id="page-contact" class="page-section hidden animate-fade-in max-w-xl mx-auto pt-8">
            <div class="text-center mb-8">
                <h2 class="text-3xl font-semibold text-black dark:text-white mb-2">Get in touch</h2>
                <p class="text-zinc-500">We'd love to hear from you. Send us a message.</p>
            </div>
            
            <div class="glass-panel rounded-2xl p-8">
                <form onsubmit="event.preventDefault(); alert('Message sent! We will get back to you shortly.');" class="space-y-4">
                    <div class="grid grid-cols-2 gap-4">
                        <div class="space-y-1">
                            <label class="text-xs font-medium text-zinc-500">First Name</label>
                            <input type="text" class="w-full bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-white/10 rounded-lg px-3 py-2 text-sm focus:ring-1 focus:ring-emerald-500 outline-none transition-colors text-black dark:text-white" placeholder="Jane">
                        </div>
                        <div class="space-y-1">
                            <label class="text-xs font-medium text-zinc-500">Last Name</label>
                            <input type="text" class="w-full bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-white/10 rounded-lg px-3 py-2 text-sm focus:ring-1 focus:ring-emerald-500 outline-none transition-colors text-black dark:text-white" placeholder="Doe">
                        </div>
                    </div>
                    <div class="space-y-1">
                        <label class="text-xs font-medium text-zinc-500">Email</label>
                        <input type="email" class="w-full bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-white/10 rounded-lg px-3 py-2 text-sm focus:ring-1 focus:ring-emerald-500 outline-none transition-colors text-black dark:text-white" placeholder="jane@example.com">
                    </div>
                    <div class="space-y-1">
                        <label class="text-xs font-medium text-zinc-500">Message</label>
                        <textarea rows="4" class="w-full bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-white/10 rounded-lg px-3 py-2 text-sm focus:ring-1 focus:ring-emerald-500 outline-none transition-colors text-black dark:text-white" placeholder="How can we help?"></textarea>
                    </div>
                    <button class="w-full bg-black dark:bg-white text-white dark:text-black font-medium py-2.5 rounded-lg hover:opacity-90 transition-opacity">Send Message</button>
                </form>
            </div>
        </div>

    </main>

    <!-- Footer -->
    <footer class="border-t border-black/5 dark:border-white/5 bg-white dark:bg-[#020202] py-12 mt-auto">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 grid grid-cols-1 md:grid-cols-4 gap-8">
            <div class="space-y-4">
                <div class="flex items-center gap-2">
                    <iconify-icon icon="lucide:sparkles" class="text-black dark:text-white" stroke-width="1.5"></iconify-icon>
                    <span class="text-black dark:text-white font-medium tracking-tight">Stylo.ai</span>
                </div>
                <p class="text-xs text-zinc-500">
                    Â© 2023 Stylo AI Inc.<br>All rights reserved.
                </p>
                <div class="flex gap-4">
                    <a href="#" class="text-zinc-400 hover:text-black dark:hover:text-white"><iconify-icon icon="lucide:twitter" stroke-width="1.5"></iconify-icon></a>
                    <a href="#" class="text-zinc-400 hover:text-black dark:hover:text-white"><iconify-icon icon="lucide:instagram" stroke-width="1.5"></iconify-icon></a>
                    <a href="#" class="text-zinc-400 hover:text-black dark:hover:text-white"><iconify-icon icon="lucide:github" stroke-width="1.5"></iconify-icon></a>
                </div>
            </div>
            <div>
                <h4 class="text-black dark:text-white text-sm font-medium mb-4">Product</h4>
                <ul class="space-y-2 text-xs text-zinc-500">
                    <li><button onclick="navigateTo('how-it-works')" class="hover:text-zinc-800 dark:hover:text-zinc-300">Features</button></li>
                    <li><button onclick="navigateTo('pricing')" class="hover:text-zinc-800 dark:hover:text-zinc-300">Pricing</button></li>
                </ul>
            </div>
            <div>
                <h4 class="text-black dark:text-white text-sm font-medium mb-4">Company</h4>
                <ul class="space-y-2 text-xs text-zinc-500">
                    <li><button onclick="navigateTo('about')" class="hover:text-zinc-800 dark:hover:text-zinc-300">About</button></li>
                    <li><button onclick="navigateTo('blog')" class="hover:text-zinc-800 dark:hover:text-zinc-300">Blog</button></li>
                    <li><button onclick="navigateTo('careers')" class="hover:text-zinc-800 dark:hover:text-zinc-300">Careers</button></li>
                </ul>
            </div>
            <div>
                <h4 class="text-black dark:text-white text-sm font-medium mb-4">Legal</h4>
                <ul class="space-y-2 text-xs text-zinc-500">
                    <li><button onclick="navigateTo('privacy')" class="hover:text-zinc-800 dark:hover:text-zinc-300">Privacy</button></li>
                    <li><button onclick="navigateTo('terms')" class="hover:text-zinc-800 dark:hover:text-zinc-300">Terms</button></li>
                </ul>
            </div>
        </div>
    </footer>

    <!-- Auth Modal -->
    <div id="auth-modal" class="fixed inset-0 z-[100] hidden">
        <!-- Backdrop -->
        <div class="absolute inset-0 bg-black/60 backdrop-blur-sm" onclick="closeAuthModal()"></div>
        
        <!-- Modal Content -->
        <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-full max-w-md p-4">
            <div class="bg-white dark:bg-[#09090b] rounded-2xl border border-black/5 dark:border-white/10 shadow-2xl overflow-hidden p-8 relative">
                <button onclick="closeAuthModal()" class="absolute top-4 right-4 text-zinc-400 hover:text-black dark:hover:text-white">
                    <iconify-icon icon="lucide:x" stroke-width="1.5"></iconify-icon>
                </button>

                <div class="text-center mb-6">
                    <div class="inline-block p-3 rounded-xl bg-zinc-100 dark:bg-white/5 mb-4">
                        <iconify-icon icon="lucide:user-check" class="text-2xl text-black dark:text-white" stroke-width="1.5"></iconify-icon>
                    </div>
                    <h3 id="auth-title" class="text-xl font-semibold text-black dark:text-white">Welcome back</h3>
                    <p id="auth-desc" class="text-sm text-zinc-500 mt-1">Enter your details to access your wardrobe.</p>
                </div>

                <form id="auth-form" onsubmit="handleAuth(event)" class="space-y-4">
                    <div class="space-y-1">
                        <label class="text-xs font-medium text-zinc-500">Email Address</label>
                        <input type="email" id="auth-email" required class="w-full bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-white/10 rounded-lg px-3 py-2.5 text-sm focus:ring-1 focus:ring-black dark:focus:ring-white outline-none transition-colors text-black dark:text-white" placeholder="you@example.com">
                    </div>
                    <div class="space-y-1">
                        <label class="text-xs font-medium text-zinc-500">Password</label>
                        <input type="password" id="auth-pass" required minlength="6" class="w-full bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-white/10 rounded-lg px-3 py-2.5 text-sm focus:ring-1 focus:ring-black dark:focus:ring-white outline-none transition-colors text-black dark:text-white" placeholder="Min 6 characters">
                    </div>
                    
                    <div id="auth-error" class="text-red-500 text-xs text-center hidden"></div>
                    <div id="auth-success" class="text-emerald-500 text-xs text-center hidden"></div>

                    <button type="submit" id="auth-submit-btn" class="w-full bg-black dark:bg-white text-white dark:text-black font-medium py-2.5 rounded-lg hover:opacity-90 transition-opacity mt-2">Log In</button>
                </form>

                <div class="mt-6 text-center">
                    <p class="text-xs text-zinc-500">
                        <span id="auth-footer-text">Don't have an account?</span>
                        <button id="auth-switch-btn" onclick="toggleAuthMode()" class="text-black dark:text-white font-medium hover:underline ml-1">Sign up</button>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script>
        // === THEME LOGIC ===
        function toggleThemeMenu() {
            document.getElementById('theme-menu').classList.toggle('hidden');
        }

        function setTheme(theme) {
            const html = document.documentElement;
            const icon = document.getElementById('theme-icon');
            
            if (theme === 'system') {
                if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    html.classList.add('dark');
                } else {
                    html.classList.remove('dark');
                }
                localStorage.removeItem('theme');
            } else if (theme === 'dark') {
                html.classList.add('dark');
                localStorage.theme = 'dark';
            } else {
                html.classList.remove('dark');
                localStorage.theme = 'light';
            }

            if (theme === 'dark' || (theme === 'system' && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                icon.setAttribute('icon', 'lucide:moon');
            } else {
                icon.setAttribute('icon', 'lucide:sun');
            }
            
            document.getElementById('theme-menu').classList.add('hidden');
        }

        if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            setTheme('dark');
        } else {
            setTheme('light');
        }

        // === ROUTING LOGIC ===
        function navigateTo(pageId) {
            document.querySelectorAll('.page-section').forEach(el => el.classList.add('hidden'));
            const target = document.getElementById('page-' + pageId);
            if(target) target.classList.remove('hidden');
            window.scrollTo(0,0);
        }

        // === AUTH LOGIC (LOCAL STORAGE) ===
        // Fixed parsing and storage logic
        let authMode = 'login'; 
        let users = [];
        
        try {
            const storedUsers = localStorage.getItem('stylo_users');
            if (storedUsers) {
                users = JSON.parse(storedUsers);
                if (!Array.isArray(users)) users = [];
            }
        } catch(e) {
            console.error("Error parsing users:", e);
            users = [];
        }

        let currentUser = localStorage.getItem('stylo_current_user');

        function updateAuthUI() {
            const loggedOut = document.getElementById('auth-logged-out');
            const loggedIn = document.getElementById('auth-logged-in');
            const displayEmail = document.getElementById('user-display-email');

            if (currentUser) {
                loggedOut.classList.add('hidden');
                loggedIn.classList.remove('hidden');
                loggedIn.classList.add('flex');
                if(displayEmail) displayEmail.textContent = currentUser;
            } else {
                loggedOut.classList.remove('hidden');
                loggedIn.classList.add('hidden');
                loggedIn.classList.remove('flex');
            }
        }
        
        updateAuthUI();

        function openAuthModal(mode) {
            authMode = mode;
            const modal = document.getElementById('auth-modal');
            const title = document.getElementById('auth-title');
            const btn = document.getElementById('auth-submit-btn');
            const footerText = document.getElementById('auth-footer-text');
            const switchBtn = document.getElementById('auth-switch-btn');
            const error = document.getElementById('auth-error');
            const success = document.getElementById('auth-success');
            const form = document.getElementById('auth-form');

            if(form) form.reset();
            if(error) error.classList.add('hidden');
            if(success) success.classList.add('hidden');
            if(modal) modal.classList.remove('hidden');

            if (mode === 'login') {
                title.textContent = 'Welcome back';
                btn.textContent = 'Log In';
                footerText.textContent = "Don't have an account?";
                switchBtn.textContent = 'Sign up';
            } else {
                title.textContent = 'Create an account';
                btn.textContent = 'Sign Up';
                footerText.textContent = "Already have an account?";
                switchBtn.textContent = 'Log in';
            }
        }

        function closeAuthModal() {
            document.getElementById('auth-modal').classList.add('hidden');
        }

        function toggleAuthMode() {
            openAuthModal(authMode === 'login' ? 'signup' : 'login');
        }

        function handleAuth(e) {
            e.preventDefault();
            const email = document.getElementById('auth-email').value.trim();
            const pass = document.getElementById('auth-pass').value.trim();
            const error = document.getElementById('auth-error');
            const success = document.getElementById('auth-success');
            
            error.classList.add('hidden');
            success.classList.add('hidden');

            if (!email || !pass) {
                error.textContent = 'Please fill in all fields.';
                error.classList.remove('hidden');
                return;
            }

            if (authMode === 'signup') {
                // Check if user already exists
                const exists = users.find(u => u.email === email);
                if (exists) {
                    error.textContent = 'Account already exists. Please log in.';
                    error.classList.remove('hidden');
                    return;
                }

                // Register new user
                users.push({ email, pass });
                try {
                    localStorage.setItem('stylo_users', JSON.stringify(users));
                    success.textContent = 'Account created successfully! Switching to login...';
                    success.classList.remove('hidden');
                    
                    // Auto switch to login after short delay
                    setTimeout(() => {
                        authMode = 'login';
                        openAuthModal('login');
                        document.getElementById('auth-email').value = email;
                        document.getElementById('auth-success').textContent = 'Account created! Please log in.';
                        document.getElementById('auth-success').classList.remove('hidden');
                    }, 1000);
                } catch (err) {
                    error.textContent = 'Error saving account. Please try again.';
                    error.classList.remove('hidden');
                }

            } else {
                // Login Logic
                const user = users.find(u => u.email === email && u.pass === pass);
                
                if (user) {
                    currentUser = email;
                    localStorage.setItem('stylo_current_user', email);
                    closeAuthModal();
                    updateAuthUI();
                    // Show alert or toast? No, just close modal.
                } else {
                    // Check if email exists but wrong password
                    const emailExists = users.find(u => u.email === email);
                    if(emailExists) {
                        error.textContent = 'Incorrect password.';
                    } else {
                        error.textContent = 'No account found with this email.';
                    }
                    error.classList.remove('hidden');
                }
            }
        }

        function logout() {
            currentUser = null;
            localStorage.removeItem('stylo_current_user');
            updateAuthUI();
            navigateTo('home');
        }


        // === OUTFIT GENERATION LOGIC ===
        let selectedGender = 'male';
        const btnMale = document.getElementById('btn-male');
        const btnFemale = document.getElementById('btn-female');

        // Outfit Database to simulate AI results
        const outfitDatabase = {
            'male_casual': 'https://images.unsplash.com/photo-1516826957135-bdd83a63b02d?q=80&w=2070&auto=format&fit=crop',
            'male_business': 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?q=80&w=1974&auto=format&fit=crop',
            'male_party': 'https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?q=80&w=1974&auto=format&fit=crop',
            'male_gym': 'https://images.unsplash.com/photo-1583468982228-19f19164aee2?q=80&w=1971&auto=format&fit=crop',
            'male_winter': 'https://images.unsplash.com/photo-1487222477894-8943e31ef7b2?q=80&w=1995&auto=format&fit=crop',
            'male_wedding': 'https://images.unsplash.com/photo-1551460590-798836528d22?q=80&w=1925&auto=format&fit=crop',
            'male_date': 'https://images.unsplash.com/photo-1492447273231-0f8fecec1e3a?q=80&w=1974&auto=format&fit=crop',
            
            'female_casual': 'https://images.unsplash.com/photo-1515886657613-9f3515b0c78f?q=80&w=2020&auto=format&fit=crop',
            'female_business': 'https://images.unsplash.com/photo-1573496359142-b8d87734a5a2?q=80&w=1976&auto=format&fit=crop',
            'female_party': 'https://images.unsplash.com/photo-1566737236500-c8ac43014a67?q=80&w=2070&auto=format&fit=crop',
            'female_gym': 'https://images.unsplash.com/photo-1518310383802-640c2de311b2?q=80&w=2070&auto=format&fit=crop',
            'female_winter': 'https://images.unsplash.com/photo-1542295669297-4d352b042bca?q=80&w=1974&auto=format&fit=crop',
            'female_wedding': 'https://images.unsplash.com/photo-1595777457583-95e059d581b8?q=80&w=1983&auto=format&fit=crop',
            'female_date': 'https://images.unsplash.com/photo-1496747611176-843222e1e57c?q=80&w=2073&auto=format&fit=crop'
        };

        function selectGender(gender) {
            selectedGender = gender;
            if (gender === 'male') {
                btnMale.className = "flex items-center justify-center gap-2 py-2.5 rounded-md text-sm font-medium transition-all bg-black dark:bg-zinc-800 text-white shadow-sm ring-1 ring-black/5 dark:ring-white/10";
                btnFemale.className = "flex items-center justify-center gap-2 py-2.5 rounded-md text-sm font-medium transition-all text-zinc-500 hover:text-zinc-800 dark:hover:text-zinc-300";
            } else {
                btnFemale.className = "flex items-center justify-center gap-2 py-2.5 rounded-md text-sm font-medium transition-all bg-black dark:bg-zinc-800 text-white shadow-sm ring-1 ring-black/5 dark:ring-white/10";
                btnMale.className = "flex items-center justify-center gap-2 py-2.5 rounded-md text-sm font-medium transition-all text-zinc-500 hover:text-zinc-800 dark:hover:text-zinc-300";
            }
        }

        const fileInput = document.getElementById('file-upload');
        const uploadPlaceholder = document.getElementById('upload-placeholder');
        const uploadSuccess = document.getElementById('upload-success');
        const filenameDisplay = document.getElementById('filename');
        const userPreview = document.getElementById('user-preview');
        const emptyState = document.getElementById('empty-state');
        const generateBtn = document.getElementById('generate-btn');
        let fileUploaded = false;

        if (fileInput) {
            fileInput.addEventListener('change', function(e) {
                if (e.target.files && e.target.files[0]) {
                    const file = e.target.files[0];
                    const reader = new FileReader();

                    reader.onload = function(e) {
                        userPreview.src = e.target.result;
                        userPreview.classList.remove('hidden');
                        emptyState.classList.add('hidden');
                        
                        uploadPlaceholder.classList.add('hidden');
                        uploadSuccess.classList.remove('hidden');
                        filenameDisplay.textContent = file.name.length > 20 ? file.name.substring(0, 15) + '...' : file.name;
                        
                        fileUploaded = true;
                        generateBtn.removeAttribute('disabled');
                    }
                    reader.readAsDataURL(file);
                }
            });
        }

        function generateOutfit() {
            if (!currentUser) {
                openAuthModal('login');
                const authError = document.getElementById('auth-error');
                if(authError) {
                    authError.textContent = "Please log in to generate outfits.";
                    authError.classList.remove('hidden');
                }
                return;
            }

            if (!fileUploaded) {
                alert("Please upload a photo first.");
                return;
            }

            const occasion = document.getElementById('occasion-select').value;
            const loaderOverlay = document.getElementById('loader-overlay');
            const resultContainer = document.getElementById('result-container');
            const resultImage = document.getElementById('result-image');
            const btnText = generateBtn.querySelector('span');

            loaderOverlay.classList.remove('hidden');
            resultContainer.classList.add('hidden');
            generateBtn.setAttribute('disabled', 'true');
            btnText.innerHTML = '<iconify-icon icon="lucide:loader-2" class="animate-spin" stroke-width="1.5"></iconify-icon> Processing...';

            setTimeout(() => {
                loaderOverlay.innerHTML = '<div class="loader mb-4 text-black dark:text-white"></div><p class="text-zinc-600 dark:text-zinc-300 text-sm font-medium animate-pulse">Matching textures...</p>';
            }, 1000);

            setTimeout(() => {
                loaderOverlay.classList.add('hidden');
                resultContainer.classList.remove('hidden');
                
                // Get the mapped image with fallback
                const key = `${selectedGender}_${occasion}`;
                let finalImage = outfitDatabase[key] || outfitDatabase[`${selectedGender}_casual`];
                
                // Fallback for missing keys in simple demo
                if (!outfitDatabase[key]) {
                    // Try to map new occasions to existing images for demo
                    if (occasion === 'summer') finalImage = outfitDatabase[`${selectedGender}_casual`];
                    else if (occasion === 'festival') finalImage = outfitDatabase[`${selectedGender}_party`];
                    else if (occasion === 'airport') finalImage = outfitDatabase[`${selectedGender}_gym`];
                    else finalImage = outfitDatabase[`${selectedGender}_casual`];
                }

                resultImage.src = finalImage;
                
                // Reset opacity for fade in
                resultImage.style.opacity = '0';
                setTimeout(() => {
                    resultImage.style.opacity = '1';
                }, 100);

                btnText.innerHTML = '<iconify-icon icon="lucide:wand-2" stroke-width="1.5"></iconify-icon> Regenerate';
                generateBtn.removeAttribute('disabled');
            }, 2500);
        }
    </script>
</body>
</html>
